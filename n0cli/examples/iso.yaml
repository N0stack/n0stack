DeleteVirtualMachine:
  type: VirtualMachine
  action: DeleteVirtualMachine
  args:
    name: test-iso
  ignore_error: true

DeleteBlockStorage:
  type: BlockStorage
  action: DeleteBlockStorage
  args:
    name: ubuntu-1804-iso-test
  depends_on:
    - DeleteVirtualMachine
  ignore_error: true

CreateBlockStorage:
  type: BlockStorage
  action: CreateBlockStorage
  args:
    name: ubuntu-1804-iso-test
    annotations:
      n0core/provisioning/request_node_name: test
    request_bytes: 1073741824
    limit_bytes: 10737418240
  depends_on:
    - DeleteBlockStorage

FetchBlockStorage:
  type: BlockStorage
  action: FetchBlockStorage
  args:
    name: ubuntu-1804-iso
    annotations:
      n0core/provisioning/request_node_name: test
    request_bytes: 1073741824
    limit_bytes: 1073741824
    source_url: http://cdimage.ubuntu.com/releases/18.04.1/release/ubuntu-18.04.1-server-amd64.iso
  ignore_error: true

ApplyNetwork:
  type: Network
  action: ApplyNetwork
  args:
    name: test-network
    ipv4_cidr: 192.168.0.0/24

CreateVirtualMachine:
  type: VirtualMachine
  action: CreateVirtualMachine
  args:
    name: test-iso
    annotations:
      n0core/provisioning/request_node_name: test
    request_cpu_milli_core: 10
    limit_cpu_milli_core: 1000
    request_memory_bytes: 1073741824
    limit_memory_bytes: 1073741824
    block_storage_names:
      - ubuntu-1804-iso-test
      - ubuntu-1804-iso
    nics:
      - network_name: test-network
  depends_on:
    - FetchBlockStorage
    - CreateBlockStorage
    - ApplyNetwork
